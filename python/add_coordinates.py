#!/usr/bin/env python3
"""
Add latitude and longitude coordinates for capital cities to countries.csv
"""

import pandas as pd

# Read the existing CSV file
df = pd.read_csv('/Users/eshvarov/Github/potato-analytics/data/countries.csv')

# Dictionary mapping capitals to their coordinates (latitude, longitude)
capital_coordinates = {
    'Kabul': (34.5553, 69.2075),
    'Tirana': (41.3275, 19.8189),
    'Algiers': (36.7538, 3.0588),
    'Pago Pago': (-14.2781, -170.7025),
    'Andorra la Vella': (42.5063, 1.5218),
    'Luanda': (-8.8390, 13.2894),
    'The Valley': (18.2206, -63.0686),
    "Saint John's": (17.1274, -61.8468),
    'Buenos Aires': (-34.6118, -58.3960),
    'Yerevan': (40.1792, 44.4991),
    'Oranjestad': (12.5092, -70.0086),
    'Canberra': (-35.2809, 149.1300),
    'Vienna': (48.2082, 16.3738),
    'Baku': (40.4093, 49.8671),
    'Nassau': (25.0443, -77.3504),
    'Manama': (26.2285, 50.5860),
    'Dhaka': (23.8103, 90.4125),
    'Bridgetown': (13.1939, -59.6134),
    'Minsk': (53.9006, 27.5590),
    'Brussels': (50.8503, 4.3517),
    'Belmopan': (17.2510, -88.7590),
    'Porto-Novo': (6.4969, 2.6283),
    'Hamilton': (32.2942, -64.7839),
    'Thimphu': (27.4728, 89.6390),
    'Sucre': (-19.0196, -65.2619),
    'Kralendijk': (12.1464, -68.2765),
    'Sarajevo': (43.8476, 18.3564),
    'Gaborone': (-24.6282, 25.9231),
    'Brasília': (-15.8267, -47.9218),
    'Bandar Seri Begawan': (4.9031, 114.9398),
    'Sofia': (42.6977, 23.3219),
    'Ouagadougou': (12.3714, -1.5197),
    'Gitega': (-3.4264, 29.9306),
    'Phnom Penh': (11.5564, 104.9282),
    'Yaoundé': (3.8480, 11.5021),
    'Ottawa': (45.4215, -75.6972),
    'Praia': (14.9177, -23.5092),
    'George Town': (19.2866, -81.3744),
    'Bangui': (4.3947, 18.5582),
    "N'Djamena": (12.1348, 15.0557),
    'Santiago': (-33.4489, -70.6693),
    'Beijing': (39.9042, 116.4074),
    'Flying Fish Cove': (-10.4475, 105.6904),
    'West Island': (-12.1642, 96.8296),
    'Bogotá': (4.7110, -74.0721),
    'Moroni': (-11.7022, 43.2551),
    'Brazzaville': (-4.2634, 15.2429),
    'Kinshasa': (-4.4419, 15.2663),
    'Avarua': (-21.2120, -159.7762),
    'San José': (9.9281, -84.0907),
    'Zagreb': (45.8150, 15.9819),
    'Havana': (23.1136, -82.3666),
    'Willemstad': (12.1696, -68.9900),
    'Nicosia': (35.1856, 33.3823),
    'Prague': (50.0755, 14.4378),
    'Yamoussoukro': (6.8276, -5.2893),
    'Copenhagen': (55.6761, 12.5683),
    'Djibouti': (11.8251, 42.5903),
    'Roseau': (15.3017, -61.3885),
    'Santo Domingo': (18.4861, -69.9312),
    'Quito': (-0.1807, -78.4678),
    'Cairo': (30.0444, 31.2357),
    'San Salvador': (13.6929, -89.2182),
    'Malabo': (3.7523, 8.7741),
    'Asmara': (15.3229, 38.9251),
    'Tallinn': (59.4370, 24.7536),
    'Mbabane': (-26.3054, 31.1367),
    'Addis Ababa': (9.1450, 40.4897),
    'Stanley': (-51.6973, -57.8570),
    'Tórshavn': (62.0107, -6.7761),
    'Suva': (-18.1248, 178.4501),
    'Helsinki': (60.1699, 24.9384),
    'Paris': (48.8566, 2.3522),
    'Cayenne': (4.9346, -52.3303),
    'Papeete': (-17.5516, -149.5585),
    'Libreville': (0.4162, 9.4673),
    'Banjul': (13.4549, -16.5790),
    'Tbilisi': (41.7151, 44.8271),
    'Berlin': (52.5200, 13.4050),
    'Accra': (5.6037, -0.1870),
    'Gibraltar': (36.1408, -5.3536),
    'Athens': (37.9755, 23.7348),
    'Nuuk': (64.1836, -51.7214),
    "Saint George's": (12.0566, -61.7485),
    'Basse-Terre': (15.9980, -61.7321),
    'Hagåtña': (13.4745, 144.7504),
    'Guatemala City': (14.6349, -90.5069),
    'Saint Peter Port': (49.4659, -2.5522),
    'Conakry': (9.6412, -13.5784),
    'Bissau': (11.8816, -15.6178),
    'Georgetown': (6.8013, -58.1551),
    'Port-au-Prince': (18.5944, -72.3074),
    'Vatican City': (41.9029, 12.4534),
    'Tegucigalpa': (14.0723, -87.1921),
    'Hong Kong': (22.3193, 114.1694),
    'Budapest': (47.4979, 19.0402),
    'Reykjavík': (64.1466, -21.9426),
    'New Delhi': (28.6139, 77.2090),
    'Jakarta': (-6.2088, 106.8456),
    'Tehran': (35.6892, 51.3890),
    'Baghdad': (33.3152, 44.3661),
    'Dublin': (53.3498, -6.2603),
    'Douglas': (54.1509, -4.4821),
    'Jerusalem': (31.7683, 35.2137),
    'Rome': (41.9028, 12.4964),
    'Kingston': (17.9970, -76.7936),
    'Tokyo': (35.6762, 139.6503),
    'Saint Helier': (49.1919, -2.1071),
    'Amman': (31.9539, 35.9106),
    'Nur-Sultan': (51.1694, 71.4491),
    'Nairobi': (-1.2921, 36.8219),
    'Tarawa': (1.3382, 173.0176),
    'Pyongyang': (39.0392, 125.7625),
    'Seoul': (37.5665, 126.9780),
    'Kuwait City': (29.3759, 47.9774),
    'Bishkek': (42.8746, 74.5698),
    'Vientiane': (17.9757, 102.6331),
    'Riga': (56.9496, 24.1052),
    'Beirut': (33.8938, 35.5018),
    'Maseru': (-29.3151, 27.4869),
    'Monrovia': (6.2907, -10.7605),
    'Tripoli': (32.8872, 13.1913),
    'Vaduz': (47.1410, 9.5209),
    'Vilnius': (54.6872, 25.2797),
    'Luxembourg': (49.6116, 6.1319),
    'Macao': (22.1987, 113.5439),
    'Skopje': (41.9973, 21.4280),
    'Antananarivo': (-18.8792, 47.5079),
    'Lilongwe': (-13.9626, 33.7741),
    'Kuala Lumpur': (3.1390, 101.6869),
    'Malé': (4.1755, 73.5093),
    'Bamako': (12.6392, -8.0029),
    'Valletta': (35.8989, 14.5146),
    'Majuro': (7.1315, 171.1845),
    'Fort-de-France': (14.6118, -61.0809),
    'Nouakchott': (18.0735, -15.9582),
    'Port Louis': (-20.1654, 57.5015),
    'Mamoudzou': (-12.7806, 45.2278),
    'Mexico City': (19.4326, -99.1332),
    'Palikir': (6.9248, 158.1611),
    'Chișinău': (47.0105, 28.8638),
    'Monaco': (43.7384, 7.4246),
    'Ulaanbaatar': (47.8864, 106.9057),
    'Podgorica': (42.4304, 19.2594),
    'Plymouth': (16.7063, -62.2176),
    'Rabat': (34.0209, -6.8417),
    'Maputo': (-25.9692, 32.5732),
    'Naypyidaw': (19.7633, 96.0785),
    'Windhoek': (-22.5609, 17.0658),
    'Yaren': (-0.5477, 166.9209),
    'Kathmandu': (27.7172, 85.3240),
    'Amsterdam': (52.3676, 4.9041),
    'Nouméa': (-22.2758, 166.4581),
    'Wellington': (-41.2865, 174.7762),
    'Managua': (12.1150, -86.2362),
    'Niamey': (13.5116, 2.1254),
    'Abuja': (9.0765, 7.3986),
    'Alofi': (-19.0595, -169.9187),
    'Kingston': (17.9970, -76.7936),  # Note: Same as Jamaica's Kingston
    'Saipan': (15.2069, 145.7545),
    'Oslo': (59.9139, 10.7522),
    'Muscat': (23.5859, 58.4059),
    'Islamabad': (33.7294, 73.0931),
    'Ngerulmud': (7.5006, 134.6242),
    'East Jerusalem': (31.7683, 35.2137),
    'Panama City': (8.9824, -79.5199),
    'Port Moresby': (-9.4438, 147.1803),
    'Asunción': (-25.2637, -57.5759),
    'Lima': (-12.0464, -77.0428),
    'Manila': (14.5995, 120.9842),
    'Adamstown': (-25.0662, -130.1015),
    'Warsaw': (52.2297, 21.0122),
    'Lisbon': (38.7223, -9.1393),
    'San Juan': (18.4655, -66.1057),
    'Doha': (25.2854, 51.5310),
    'Bucharest': (44.4268, 26.1025),
    'Moscow': (55.7558, 37.6176),
    'Kigali': (-1.9706, 30.1044),
    'Saint-Denis': (-20.8823, 55.4504),
    'Gustavia': (17.8958, -62.8508),
    'Jamestown': (-15.9387, -5.7168),
    'Basseterre': (17.3026, -62.7177),
    'Castries': (14.0101, -60.9875),
    'Marigot': (18.0731, -63.0822),
    'Saint-Pierre': (46.7719, -56.1773),
    'Kingstown': (13.1587, -61.2248),
    'Apia': (-13.8506, -171.7513),
    'San Marino': (43.9424, 12.4578),
    'São Tomé': (0.3365, 6.7273),
    'Riyadh': (24.7136, 46.6753),
    'Dakar': (14.7167, -17.4677),
    'Belgrade': (44.7866, 20.4489),
    'Victoria': (-4.6796, 55.4920),
    'Freetown': (8.4840, -13.2299),
    'Singapore': (1.3521, 103.8198),
    'Philipsburg': (18.0267, -63.0548),
    'Bratislava': (48.1486, 17.1077),
    'Ljubljana': (46.0569, 14.5058),
    'Honiara': (-9.4280, 159.9495),
    'Mogadishu': (2.0469, 45.3182),
    'Cape Town': (-33.9249, 18.4241),
    'Juba': (4.8594, 31.5713),
    'Madrid': (40.4168, -3.7038),
    'Colombo': (6.9271, 79.8612),
    'Khartoum': (15.5007, 32.5599),
    'Paramaribo': (5.8520, -55.2038),
    'Longyearbyen': (78.2232, 15.6267),
    'Stockholm': (59.3293, 18.0686),
    'Bern': (46.9481, 7.4474),
    'Damascus': (33.5138, 36.2765),
    'Taipei': (25.0330, 121.5654),
    'Dushanbe': (38.5598, 68.7870),
    'Dodoma': (-6.1630, 35.7516),
    'Bangkok': (13.7563, 100.5018),
    'Dili': (-8.5569, 125.5603),
    'Lomé': (6.1375, 1.2123),
    "Nuku'alofa": (-21.1347, -175.2018),
    'Port of Spain': (10.6596, -61.5280),
    'Tunis': (36.8065, 10.1815),
    'Ankara': (39.9334, 32.8597),
    'Ashgabat': (37.9601, 58.3261),
    'Cockburn Town': (21.4612, -71.1419),
    'Funafuti': (-8.5243, 179.1942),
    'Kampala': (0.3476, 32.5825),
    'Kyiv': (50.4501, 30.5234),
    'Abu Dhabi': (24.2992, 54.6972),
    'London': (51.5074, -0.1278),
    'Washington, D.C.': (38.9072, -77.0369),
    'Montevideo': (-34.9011, -56.1645),
    'Tashkent': (41.2995, 69.2401),
    'Port Vila': (-17.7334, 168.3273),
    'Caracas': (10.4806, -66.9036),
    'Hanoi': (21.0285, 105.8542),
    'Road Town': (18.4208, -64.6196),
    'Charlotte Amalie': (18.3419, -64.9307),
    'Mata-Utu': (-13.2816, -176.1745),
    'El Aaiún': (27.1536, -13.2033),
    "Sana'a": (15.3694, 44.1910),
    'Lusaka': (-15.3875, 28.3228),
    'Harare': (-17.8252, 31.0335),
    'Mariehamn': (60.0973, 19.9345)
}

# Create latitude and longitude columns
df['Latitude'] = df['Capital'].map(lambda x: capital_coordinates.get(x, (None, None))[0] if pd.notna(x) else None)
df['Longitude'] = df['Capital'].map(lambda x: capital_coordinates.get(x, (None, None))[1] if pd.notna(x) else None)

# Save the updated CSV
output_file = '/Users/eshvarov/Github/potato-analytics/data/countries.csv'
df.to_csv(output_file, index=False)

print(f"Updated countries.csv with Latitude and Longitude columns")
print(f"Added coordinates for capitals in {len(df)} countries/territories")
print("\nSample of updated data:")
print(df[['Name', 'Capital', 'Latitude', 'Longitude']].head(10))

print(f"\nCountries with coordinates:")
with_coords = df[df['Latitude'].notna()]
print(f"Found coordinates for {len(with_coords)} capitals")

print(f"\nCountries without coordinates (no capital or uninhabited):")
no_coords = df[df['Latitude'].isna()]
for _, row in no_coords.iterrows():
    print(f"  {row['Name']} - Capital: {row['Capital'] if pd.notna(row['Capital']) else 'None'}")
